<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Zeichenketten – Einführung in die Datenwissenschaft mit Excel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../kapitel/boolsche-operationen/kapitel.html" rel="next">
<link href="../../kapitel/variablen/kapitel.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../kapitel/variablen/kapitel.html">Mathematik der Daten</a></li><li class="breadcrumb-item"><a href="../../kapitel/zeichenketten/kapitel.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Zeichenketten</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Einführung in die Datenwissenschaft mit Excel</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dxiai/dxi-excel" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Ausgangslage und Vorbereitung</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Einleitung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/excel-versionen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Excel Versionen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/02_oberflaeche.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bedienoberfläche</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/01_jargon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Excel Jargon</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Datenquellen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-sammeln/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Daten sammeln</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/datentypen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datentypen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-importieren/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Daten importieren</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Mathematik der Daten</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/variablen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Variablen, Funktionen und Operatoren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/zeichenketten/kapitel.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Zeichenketten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/boolsche-operationen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Aussagenlogik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/vektor-operationen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Vektoroperationen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/matrix-operationen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix-Operationen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/kodieren-gruppieren/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Indizieren und Gruppieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-formen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Daten formen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Deskriptive Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-beschreiben/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Daten beschreiben</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-visualisieren/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Daten visualisieren</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referenzen</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#die-leere-zeichenkette" id="toc-die-leere-zeichenkette" class="nav-link active" data-scroll-target="#die-leere-zeichenkette"><span class="header-section-number">9.1</span> Die leere Zeichenkette</a></li>
  <li><a href="#nicht-druckbare-zeichen" id="toc-nicht-druckbare-zeichen" class="nav-link" data-scroll-target="#nicht-druckbare-zeichen"><span class="header-section-number">9.2</span> Nicht-druckbare Zeichen</a></li>
  <li><a href="#zeichenketten-trennen" id="toc-zeichenketten-trennen" class="nav-link" data-scroll-target="#zeichenketten-trennen"><span class="header-section-number">9.3</span> Zeichenketten trennen</a>
  <ul class="collapse">
  <li><a href="#einzelne-symbole-extrahieren" id="toc-einzelne-symbole-extrahieren" class="nav-link" data-scroll-target="#einzelne-symbole-extrahieren"><span class="header-section-number">9.3.1</span> Einzelne Symbole extrahieren</a></li>
  <li><a href="#zeichenketten-vor-und-nach-einem-trenner-erhalten" id="toc-zeichenketten-vor-und-nach-einem-trenner-erhalten" class="nav-link" data-scroll-target="#zeichenketten-vor-und-nach-einem-trenner-erhalten"><span class="header-section-number">9.3.2</span> Zeichenketten vor und nach einem Trenner erhalten</a></li>
  <li><a href="#festkodierte-werte-trennen" id="toc-festkodierte-werte-trennen" class="nav-link" data-scroll-target="#festkodierte-werte-trennen"><span class="header-section-number">9.3.3</span> Festkodierte Werte trennen</a></li>
  <li><a href="#zeichenketten-mit-einem-separator-trennen" id="toc-zeichenketten-mit-einem-separator-trennen" class="nav-link" data-scroll-target="#zeichenketten-mit-einem-separator-trennen"><span class="header-section-number">9.3.4</span> Zeichenketten mit einem Separator trennen</a></li>
  </ul></li>
  <li><a href="#suchen-und-ersetzen" id="toc-suchen-und-ersetzen" class="nav-link" data-scroll-target="#suchen-und-ersetzen"><span class="header-section-number">9.4</span> Suchen und Ersetzen</a>
  <ul class="collapse">
  <li><a href="#löschen-von-teilzeichenketten" id="toc-löschen-von-teilzeichenketten" class="nav-link" data-scroll-target="#löschen-von-teilzeichenketten"><span class="header-section-number">9.4.1</span> Löschen von Teilzeichenketten</a></li>
  <li><a href="#zeichenketten-durch-ersetzungen-vereinheitlichen" id="toc-zeichenketten-durch-ersetzungen-vereinheitlichen" class="nav-link" data-scroll-target="#zeichenketten-durch-ersetzungen-vereinheitlichen"><span class="header-section-number">9.4.2</span> Zeichenketten durch Ersetzungen vereinheitlichen</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dxiai/dxi-excel/issues/new" class="toc-action"><i class="bi bi-github"></i>Problem melden</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../kapitel/variablen/kapitel.html">Mathematik der Daten</a></li><li class="breadcrumb-item"><a href="../../kapitel/zeichenketten/kapitel.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Zeichenketten</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-chapter-zeichenketten" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Zeichenketten</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Bisher wurden Zeichenketten als Werte behandelt. In diesem Abschnitt geht es darum, wie Zeichenketten gesäubert, bearbeitet und aufgeteilt werden.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Merke
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn Daten als Zeichenketten vorliegen, dann handelt es sich immer um <strong>diskrete Daten</strong>.</p>
</div>
</div>
<div id="tbl-ftk-zeichenketten" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ftk-zeichenketten-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;9.1: Die wichtigsten Zeichenkettenfunktionen von Excel
</figcaption>
<div aria-describedby="tbl-ftk-zeichenketten-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Excel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Länge</td>
<td><code>LÄNGE()</code></td>
</tr>
<tr class="even">
<td>Teilketten verknüpfen</td>
<td><code>TEXTKETTE()</code>/<code>TEXTVERKETTEN()</code></td>
</tr>
<tr class="odd">
<td>Teilzeichenkette finden</td>
<td><code>FINDEN()</code>/<code>SUCHEN()</code></td>
</tr>
<tr class="even">
<td>In Grossbuchstaben umwandeln</td>
<td><code>GROSS()</code></td>
</tr>
<tr class="odd">
<td>In Kleinbuchstaben umwandeln</td>
<td><code>KLEIN()</code></td>
</tr>
<tr class="even">
<td>Nur ersten Buchstaben als Grossbuchstabe</td>
<td><code>GROSS2()</code></td>
</tr>
<tr class="odd">
<td>Leerzeichen bereinigen</td>
<td><code>GLÄTTEN()</code></td>
</tr>
<tr class="even">
<td>Nicht-druckbare Zeichen entfernen</td>
<td><code>SÄUBERN()</code></td>
</tr>
<tr class="odd">
<td>Teilkette extrahieren (linksseitig)</td>
<td><code>LINKS()</code>, <code>TEXTVOR()</code></td>
</tr>
<tr class="even">
<td>Teilkette extrahieren (rechtsseitig)</td>
<td><code>RECHTS()</code>,<code>TEXTNACH()</code></td>
</tr>
<tr class="odd">
<td>Teilketten extrahieren (alle)</td>
<td><code>TEXTTEILEN()</code></td>
</tr>
<tr class="even">
<td>Teilkette zwischen zwei Positionen extrahieren</td>
<td><code>TEIL()</code></td>
</tr>
<tr class="odd">
<td>Zeichenkette ersetzen</td>
<td><code>WECHSELN()</code>, <code>ERSETZEN()</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="die-leere-zeichenkette" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="die-leere-zeichenkette"><span class="header-section-number">9.1</span> Die leere Zeichenkette</h2>
<p>Ein besonderer Fall ist die <em>leere Zeichenkette</em>. Die leere Zeichenkette wird oft als Platzhalter genutzt. Die leere Zeichenkette ist das <em>neutrale Element</em> für die Verknüpfung von Zeichenketten mit <code>TEXTKETTE()</code> oder <code>TEXTVERKETTEN()</code>.</p>
<p>In Excel lässt sich die leere Zeichenkette von der leeren Zelle nur unterscheiden, indem die Formel betrachtet wird oder die Zelle mit <code>ISTLEER()</code> (<code>FALSCH</code>) und <code>ISTTEXT()</code> (<code>WAHR</code>) überprüft wird.</p>
<p>Die leere Zeichenkette wird in Excel nur als Funktionsparameter durch doppelte Anführungszeichen eingerahmt. Soll eine leere Zeichenkette als Wert in eine Zelle eingegeben werden, dann ist ein einfacher Apostroph (’) einzugeben.</p>
<div id="exm-excel-leerezeichenkette" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.1 (Leere Zeichenkette in einer Excel-Formel)</strong></span> &nbsp;</p>
<pre><code>=WENN(1 = 1; ""; "Fehler")</code></pre>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Merke
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn in Excel eine leere Zeichenkette als Wert in eine Zelle eingetragen werden soll, dann wird ein einfaches Anführungszeichen als Wert eingegeben.</p>
</div>
</div>
<div id="fig-leerezeichenkette-eingabe" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-leerezeichenkette-eingabe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/leere_zeichenkettewert__excel.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-leerezeichenkette-eingabe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;9.1: Leere Zeichenkette als Zellenwert in Excel
</figcaption>
</figure>
</div>
</section>
<section id="nicht-druckbare-zeichen" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="nicht-druckbare-zeichen"><span class="header-section-number">9.2</span> Nicht-druckbare Zeichen</h2>
<p>In Excel werden die nicht-druckbaren Zeichen für die Darstellung und für Vergleiche entfernt, jedoch werden die nicht-druckbaren Zeichen bei der Länge und beim Extrahieren berücksichtigt. In Excel kann mit der <code>IDENTISCH()</code>-Funktion geprüft werden, ob zwei Zeichenketten die gleiche Symbolfolge beinhalten. .</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MacOS vs.&nbsp;Windows
</div>
</div>
<div class="callout-body-container callout-body">
<p>Excel unter Windows stellt nicht-druckbare Zeichen als Kästchen dar, Excel für MacOS zeigt diese Zeichen nicht an.</p>
</div>
</div>
<p>Zu den nicht-druckbaren Zeichen gehören auch Leerzeichen, Tabulatoren und Zeilenumbrüche. Diese speziellen nicht-druckbaren Zeichen sind nur erkennbar, wenn sie von druckbaren Zeichen umgeben sind.</p>
<p>Deutlich wird das an den folgenden Zeichenketten:</p>
<ul>
<li><code>Hallo</code></li>
<li><code>Hal&lt;0x07&gt;lo</code>, wobei das Symbol <code>0x07</code> für einen Piepton steht</li>
<li><code>Hal&lt;0x08&gt;lo</code>, wobei das Symbol <code>0x08</code> für einmal Rückwärtslöschen steht.</li>
</ul>
<p>Diese drei Zeichenketten haben in Excel die Längen 5, 6 und 6. Excel stellt alle drei Zeichenketten als “Hallo” dar. Ausserdem werden die Zeichenketten als gleich ausgewertet.</p>
<p>Excel entfernt über die Funktion <code>SÄUBERN()</code> alle nicht-druckbare Zeichen aus einer Zeichenkette.</p>
</section>
<section id="zeichenketten-trennen" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="zeichenketten-trennen"><span class="header-section-number">9.3</span> Zeichenketten trennen</h2>
<section id="einzelne-symbole-extrahieren" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="einzelne-symbole-extrahieren"><span class="header-section-number">9.3.1</span> Einzelne Symbole extrahieren</h3>
<p>In Excel lassen sich die einzelnen Symbole einer Zeichenkette mit der folgenden Formel extrahieren:</p>
<pre><code>=TEIL("Daten und Information"; 
      SEQUENZ(LÄNGE("Daten und Information"));
      1)</code></pre>
<p>Diese Formel hat drei Funktionsaufrufe.</p>
<ol type="1">
<li>Die Funktion <code>LÄNGE()</code> bestimmt die Anzahl der Symbole in der Zeichenkette.</li>
<li>Mit der Funktion <code>SEQUENZ()</code> werdem alle Positionen der Symbole durchnummeriert.</li>
<li>Mit <code>TEIL(Zeichenkette; Sequenz; 1)</code> wird ein Teil der Zeichenkette extrahiert, wobei für jede Position der Sequenz aus Schritt 2 eine Teilzeichenkette mit der Länge 1 erzeugt wird.</li>
</ol>
</section>
<section id="zeichenketten-vor-und-nach-einem-trenner-erhalten" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="zeichenketten-vor-und-nach-einem-trenner-erhalten"><span class="header-section-number">9.3.2</span> Zeichenketten vor und nach einem Trenner erhalten</h3>
<p>Die Funktion <code>LINKS()</code> und <code>RECHTS()</code> geben eine Teilzeichenkette mit einer festen Anzahl von Zeichen zurück. Die Funktion <code>LINKS()</code> zählt die Anzahl der Zeichen vom Beginn der Zeichenkette und <code>RECHTS()</code> vom Ende her.</p>
<div id="exm-fkt-links" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.2 (Zeichen links bis und mit der 5. Position zurückgegeben)</strong></span> &nbsp;</p>
<pre><code>= LINKS("Daten und Information"; 5)</code></pre>
</div>
<p>Weil <code>RECHTS()</code> vom Ende her zählt, kann nicht die gleiche Position wie bei <code>LINKS()</code> verwendet werden. Dazu muss die Position von der Gesamtlänge der Zeichenkette abgezogen werden (s. <a href="#exm-fkt-rechts" class="quarto-xref">Beispiel&nbsp;<span>9.3</span></a>).</p>
<div id="exm-fkt-rechts" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.3 (Zeichen rechts von der 10. Position zurückgegeben)</strong></span> &nbsp;</p>
<pre><code>= RECHTS(
    "Daten und Information"; 
    LÄNGE("Daten und Information")-10)</code></pre>
</div>
<p>Etwas eleganter arbeiten die beiden Funktionen <code>TEXTVOR()</code> und <code>TEXTNACH()</code>. Diese Funktionen suchen nach einer Teilzeichenkette und ergeben die Zeichen vor bzw. nach dieser Zeichenkette. Ein zusätzlicher Parameter ermöglicht die Suche solange zu wiederholen, bis die gesuchte Zeichenkette genau so oft gefunden wurde.</p>
<div id="exm-fkt-textvor" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.4 (<code>TEXTVOR()</code> vor dem ersten Treffer)</strong></span> &nbsp;</p>
<pre><code>= TEXTVOR("Daten und Information"; " ")</code></pre>
</div>
<div id="exm-fkt-textvor" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.5 (<code>TEXTNACH()</code> ab dem zweiten Treffer)</strong></span> &nbsp;</p>
<pre><code>= TEXTNACH("Daten und Information"; " "; 2)</code></pre>
</div>
<p>Um einen Wert zwischen zwei Treffern zu extrahieren, lassen sich die beiden Funktionen verketten. Diese Technik bietet sich immer dann an, wenn ein Wert zwischen zwei <em>unterschiedlichen</em> Markierungen extrahiert werden soll</p>
<div id="exm-fkt-textvor-nach" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.6 (Text zwischen zwei unterschiedlichen Teilketten extrahieren)</strong></span> &nbsp;</p>
<pre><code>= TEXTVOR(TEXTNACH("Daten und Information"; "ten "); " Info")</code></pre>
</div>
</section>
<section id="festkodierte-werte-trennen" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="festkodierte-werte-trennen"><span class="header-section-number">9.3.3</span> Festkodierte Werte trennen</h3>
<p>Eine festkodierte Datenstruktur ist eine Zeichenkette, die Werte an festgelegten Positionen mit konstanten Längen enthält. Diese Daten lassen sich mit der Funktion <code>TEIL()</code> extrahieren.</p>
<p>Die Funktion hat drei Argumente:</p>
<ul>
<li>Die Zeichenkette, aus der die Daten extrahiert werden sollen.</li>
<li>Die Position, an der die Daten beginnen.</li>
<li>Die Länge der Daten als Anzahl von Symbolen.</li>
</ul>
<blockquote class="blockquote">
<div id="exm-iban-trennen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.7 (IBAN in Land, Prüfziffer, Bankkennung und Kontonummer trennen)</strong></span> Die IBAN ist eine festkodierte Datenstruktur. Die IBAN enthält die Länderkennung, die Prüfziffer, die Bankkennung und die Kontonummer. Die Länge der einzelnen Daten ist konstant und die Position der Felder ist festgelegt.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Feld</th>
<th style="text-align: right;">Position</th>
<th style="text-align: right;">Länge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Land</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prüfziffer</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bankkennung</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kontonummer</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">Länge der IBAN - 10</td>
</tr>
</tbody>
</table>
<p>Die (ungültige) IBAN <code>CH12BANK1002135135</code> kann mit der <code>TEIL()</code>-Funktion in die einzelnen Felder zerlegt werden. Dazu müssen zuerst die Positionen und Längen der Felder erstellt werden. Dazu werden die Positionen und Längen der Felder untereinander geschrieben.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>5</td>
<td>10</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>5</td>
<td><code>= LÄNGE(IBAN_Nummer) - 10</code></td>
</tr>
</tbody>
</table>
<p>Diese Werte werden als Vektoren der Funktion <code>TEIL()</code> übergeben.</p>
<pre><code>= TEIL(IBAN_Nummer; A1:D1; A2:D2)</code></pre>
<p>Die Funktion <code>TEIL()</code> gibt die einzelnen Felder als Vektor zurück. Das Ergebnis ist <code>{"CH"; "12"; "BANK1"; "002135135"}</code>. Hier muss berücksichtigt werden, dass die einzelnen Felder weiterhin Zeichenketten sind.</p>
</div>
</blockquote>
</section>
<section id="zeichenketten-mit-einem-separator-trennen" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="zeichenketten-mit-einem-separator-trennen"><span class="header-section-number">9.3.4</span> Zeichenketten mit einem Separator trennen</h3>
<p>Sind Werte in einer Zeichenkette durch einen Separator getrennt, dann lassen sich die Werte mit der Funktion <code>TEXTTEILEN()</code>. Die Funktion kann eine Zeichenkette entlang von zwei Trennzeichen trennen. Dabei erzeugt die Funktion eine Matrix, wobei die Spalten durch den ersten Separator und die Zeilen durch den zweiten Separator bestimmt werden.</p>
<div id="exm-fkt-textteilen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.8 (<code>TEXTTEILEN()</code> mit festem Trennzeichen)</strong></span> &nbsp;</p>
<pre><code>= TEXTTEILEN("Daten und Information", " ")</code></pre>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Funktion <code>TEXTTEILEN()</code> kann nur auf einen Wert angewandt werden. Wird ein Zeichenkettenvektor der Funktion übergeben, wird aus jeder Zeichenkette immer nur der erste Wert getrennt und als Ergebnis ausgegeben. Excel verhindert so, dass durch das Teilen mehrerer Zeichenketten die Ergebnisse einen nicht eindeutig grossen rechteckigen Bereich mit Datentyp Zeichenkette erzeugen könnten.</p>
</div>
</div>
<p>Dieses Problem wird durch einen Trick umgangen: Dazu wird ein zweiter Separator gewählt, der nicht in den Daten vorkommt und sich vom ursprünglichen Separator unterscheidet. Existiert bereits ein Zeilentrennzeichen in den Daten, wird dieses als zweiter Separator verwendet. Anschliessend werden alle Zeichenketten mit diesem zweiten Separator als Trennzeichen mit <code>TEXTVERKETTEN()</code> verkettet. Abschliessend wird die gesamte Zeichenkette mit dem ursprüngliche Separator als Spalten- und dem zweiten Separator als Zeilentrennzeichen getrennt. Dabei werden alle nicht vorhandenen Werte in einer Zeile durch <code>#NV</code> angezeigt.</p>
<p><a href="#exm-zeichenkettenvektor-teilen" class="quarto-xref">Beispiel&nbsp;<span>9.9</span></a> trennt einen Zeichenkettenvektor mit Werten, die durch ein Leerzeichen getrennt sind. Alle Werte sind Buchstaben oder Ziffern, aber keine Satzzeichen. Deshalb kann das Komma (<code>,</code>) als Zeilentrennzeichen verwendet werden. Damit der Fehlerwert <code>#NV</code> nachfolgende Operationen nicht behindert, wird dieser durch die leere Zeichenkette ersetzt.</p>
<div id="exm-zeichenkettenvektor-teilen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.9 (Einen Zeichenkettenvektor entlang eines Trennzeichens teilen.)</strong></span> &nbsp;</p>
<pre><code>=WENNFEHLER(
    TEXTTEILEN(
        TEXTVERKETTEN(",";; Zeichenketten); 
        " "; 
        ","); 
    ""
)</code></pre>
</div>
</section>
</section>
<section id="suchen-und-ersetzen" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="suchen-und-ersetzen"><span class="header-section-number">9.4</span> Suchen und Ersetzen</h2>
<p>Eine wichtige Operation für Zeichenketten ist das Suchen-und-Ersetzen. Das Suchen-und-Ersetzen lässt sich als eine spezielle Technik zur Mustererkennung vorstellen. Dabei steht eine Anwendung im Vordergrund: Die Korrektur und Vereinheitlichung von Zeichenketten. Anstatt solche Daten umständlich über eine Benutzeroberfläche zu korrigieren, sollte das Bereinigen von Zeichenketten besser automatisch erfolgen. Excel stellt dazu die Funktion <code>WECHSELN()</code> zur Verfügung. Diese Funktion ersetzt entweder alle Vorkommnisse einer Teilzeichenkette oder nur ihr n-tes Auftreten.</p>
<div id="exm-zeichenkette-ersetzen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.10 (Alle Vorkommnisse einer Zeichenkette ersetzen)</strong></span> &nbsp;</p>
<pre><code>= WECHSELN(
    "Daten oder Information oder Wahrscheinlichkeit"; 
    "oder"; 
    "und")</code></pre>
</div>
<div id="exm-zeichenkette-einmal-ersetzen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.11 (Erstes Auftreten einer Zeichenkette ersetzen)</strong></span> &nbsp;</p>
<pre><code>= WECHSELN(
    "Daten oder Information oder Statistik"; 
    "oder"; 
    "und"; 
    1)</code></pre>
</div>
<section id="löschen-von-teilzeichenketten" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="löschen-von-teilzeichenketten"><span class="header-section-number">9.4.1</span> Löschen von Teilzeichenketten</h3>
<p>Teilzeichenketten lassen sich löschen, indem die fragliche Zeichenkette durch die leere Zeichenkette ersetzt wird.</p>
<div id="exm-zeichenkette-loeschen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 9.12 (Teilzeichenkette entfernen)</strong></span> &nbsp;</p>
<pre><code>= WECHSELN("Daten und Information"; "und"; "")</code></pre>
</div>
</section>
<section id="zeichenketten-durch-ersetzungen-vereinheitlichen" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="zeichenketten-durch-ersetzungen-vereinheitlichen"><span class="header-section-number">9.4.2</span> Zeichenketten durch Ersetzungen vereinheitlichen</h3>
<p>Bevor das eigentliche Suchen-und-Ersetzen starten kann, sollten die betreffenden Zeichenketten bereinigt werden. Die einfachste Bereinigung ist das Entfernen von überschüssigen Leerzeichen. Dazu dient die Excel Funktion <code>GLÄTTEN()</code>. <code>GLÄTTEN()</code> entfernt alle Leerzeichen am Anfang und Ende einer Zeichenkette. Alle wiederholten Leerzeichen werden mit <code>GLÄTTEN()</code> zu einem einzelnen Leerzeichen zusammengefasst.</p>
<p>Eine zweite häufig verwendete Bereinigung ist die Transformation auf Kleinbuchstaben oder Grossbuchstaben. Hierzu dienen die drei Funktionen <code>GROSS()</code>, <code>GROSS2()</code> und <code>KLEIN()</code>. Die Vereinheitlichung der Schreibweise ist ein wichtiges Werkzeug um Zeichenketten mit unterschiedlichen Schreibweisen zu vereinheitlichen. Beim Bereinigen sollte eine der verfügbaren Varianten gewählt und konsequent für die Vereinheitlichung verwendet werden. Damit wird sicher gestellt, dass alle Ersetzungen unabhängig von der Schreibweise erfolgen.</p>
<p>Für das eigentliche Ersetzen wird ein Suchvektor und einen Ersetzenvektor erzeugt. Die beiden Vektoren enthalten Paare aus Suchmuster und Ersetzung. Diese Paare sind geordnet und werden nacheinander ausgeführt.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Praxis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Satzzeichen sollte immer durch Leerzeichen und nicht durch eine leere Zeichenkette ersetzt werden. Die überzähligen Leerzeichen können anschliessend mit <code>GLÄTTEN()</code> entfernt werden. Dadurch ist gesichert, dass nicht versehentlich Elemente zusammengefügt werden. Nachdem alle Sonderzeichen entfernt wurden, sollte eine Zeichenkette noch einmal von überschüssigen Leerzeichen bereinigt werden.</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../kapitel/variablen/kapitel.html" class="pagination-link" aria-label="Variablen, Funktionen und Operatoren">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Variablen, Funktionen und Operatoren</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../kapitel/boolsche-operationen/kapitel.html" class="pagination-link" aria-label="Aussagenlogik">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Aussagenlogik</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dxiai/dxi-excel/issues/new" class="toc-action"><i class="bi bi-github"></i>Problem melden</a></li></ul></div></div></div></footer></body></html>