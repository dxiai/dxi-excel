<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Matrix-Operationen – Einführung in die Datenwissenschaft mit Excel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../kapitel/kodieren-gruppieren/kapitel.html" rel="next">
<link href="../../kapitel/vektor-operationen/kapitel.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../kapitel/variablen/kapitel.html">Mathematik der Daten</a></li><li class="breadcrumb-item"><a href="../../kapitel/matrix-operationen/kapitel.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix-Operationen</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Einführung in die Datenwissenschaft mit Excel</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dxiai/dxi-excel" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Ausgangslage und Vorbereitung</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Einleitung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/excel-versionen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Excel Versionen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/02_oberflaeche.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bedienoberfläche</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/einleitung/01_jargon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Excel Jargon</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Datenquellen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-sammeln/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Daten sammeln</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/datentypen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datentypen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-importieren/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Daten importieren</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Mathematik der Daten</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/variablen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Variablen, Funktionen und Operatoren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/zeichenketten/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Zeichenketten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/boolsche-operationen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Aussagenlogik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/vektor-operationen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Vektoroperationen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/matrix-operationen/kapitel.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix-Operationen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/kodieren-gruppieren/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Indizieren und Gruppieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-formen/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Daten formen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Deskriptive Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-beschreiben/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Daten beschreiben</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../kapitel/daten-visualisieren/kapitel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Daten visualisieren</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referenzen</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#matrizen-erstellen" id="toc-matrizen-erstellen" class="nav-link active" data-scroll-target="#matrizen-erstellen"><span class="header-section-number">12.1</span> Matrizen erstellen</a></li>
  <li><a href="#matrixdimensionen" id="toc-matrixdimensionen" class="nav-link" data-scroll-target="#matrixdimensionen"><span class="header-section-number">12.2</span> Matrixdimensionen</a></li>
  <li><a href="#matrixwerte-referenzieren" id="toc-matrixwerte-referenzieren" class="nav-link" data-scroll-target="#matrixwerte-referenzieren"><span class="header-section-number">12.3</span> Matrixwerte referenzieren</a></li>
  <li><a href="#vektorform" id="toc-vektorform" class="nav-link" data-scroll-target="#vektorform"><span class="header-section-number">12.4</span> Vektorform</a></li>
  <li><a href="#matrizen-vergleichen" id="toc-matrizen-vergleichen" class="nav-link" data-scroll-target="#matrizen-vergleichen"><span class="header-section-number">12.5</span> Matrizen vergleichen</a></li>
  <li><a href="#matrix-operationen" id="toc-matrix-operationen" class="nav-link" data-scroll-target="#matrix-operationen"><span class="header-section-number">12.6</span> Matrix Operationen</a>
  <ul class="collapse">
  <li><a href="#matrizen-transponieren" id="toc-matrizen-transponieren" class="nav-link" data-scroll-target="#matrizen-transponieren"><span class="header-section-number">12.6.1</span> Matrizen Transponieren</a></li>
  <li><a href="#sec-vektoroperationen" id="toc-sec-vektoroperationen" class="nav-link" data-scroll-target="#sec-vektoroperationen"><span class="header-section-number">12.6.2</span> Skalar- und Vektoroperationen</a></li>
  <li><a href="#kreuzproduktmatrixprodukt" id="toc-kreuzproduktmatrixprodukt" class="nav-link" data-scroll-target="#kreuzproduktmatrixprodukt"><span class="header-section-number">12.6.3</span> Kreuzprodukt/Matrixprodukt</a></li>
  <li><a href="#sec-äusseres-produkt" id="toc-sec-äusseres-produkt" class="nav-link" data-scroll-target="#sec-äusseres-produkt"><span class="header-section-number">12.6.4</span> Das äussere Produkt</a></li>
  <li><a href="#sec-paarweise-operationen" id="toc-sec-paarweise-operationen" class="nav-link" data-scroll-target="#sec-paarweise-operationen"><span class="header-section-number">12.6.5</span> Paarweise Operationen</a></li>
  </ul></li>
  <li><a href="#mathematische-hilfsoperationen" id="toc-mathematische-hilfsoperationen" class="nav-link" data-scroll-target="#mathematische-hilfsoperationen"><span class="header-section-number">12.7</span> Mathematische Hilfsoperationen</a>
  <ul class="collapse">
  <li><a href="#identitätsmatrix-erzeugen" id="toc-identitätsmatrix-erzeugen" class="nav-link" data-scroll-target="#identitätsmatrix-erzeugen"><span class="header-section-number">12.7.1</span> Identitätsmatrix erzeugen</a></li>
  <li><a href="#determinante" id="toc-determinante" class="nav-link" data-scroll-target="#determinante"><span class="header-section-number">12.7.2</span> Determinante</a></li>
  <li><a href="#inverse-matrix" id="toc-inverse-matrix" class="nav-link" data-scroll-target="#inverse-matrix"><span class="header-section-number">12.7.3</span> Inverse Matrix</a></li>
  </ul></li>
  <li><a href="#rezepte" id="toc-rezepte" class="nav-link" data-scroll-target="#rezepte"><span class="header-section-number">12.8</span> Rezepte</a>
  <ul class="collapse">
  <li><a href="#sec-zeilensummen" id="toc-sec-zeilensummen" class="nav-link" data-scroll-target="#sec-zeilensummen"><span class="header-section-number">12.8.1</span> Zeilen- und Spaltensummen</a></li>
  <li><a href="#sec-triangle-matrix" id="toc-sec-triangle-matrix" class="nav-link" data-scroll-target="#sec-triangle-matrix"><span class="header-section-number">12.8.2</span> Dreieckmatrizen erzeugen</a></li>
  <li><a href="#sec-cumsum" id="toc-sec-cumsum" class="nav-link" data-scroll-target="#sec-cumsum"><span class="header-section-number">12.8.3</span> Kumulative Summe</a></li>
  <li><a href="#sec-table-matrix" id="toc-sec-table-matrix" class="nav-link" data-scroll-target="#sec-table-matrix"><span class="header-section-number">12.8.4</span> Co-Occurence Matrizen</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dxiai/dxi-excel/issues/new" class="toc-action"><i class="bi bi-github"></i>Problem melden</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../kapitel/variablen/kapitel.html">Mathematik der Daten</a></li><li class="breadcrumb-item"><a href="../../kapitel/matrix-operationen/kapitel.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix-Operationen</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-chapter-matrix-operationen" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Matrix-Operationen</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Merke
</div>
</div>
<div class="callout-body-container callout-body">
<p>Alle Bereiche mit mehr als einer Zelle werden unabhängig von den vorliegenden Datentypen in Excel als <em>Matrix</em> bezeichnet.</p>
</div>
</div>
<p>Wie auch bei Vektoren übernimmt Excel keine Überprüfung der Bedinungen, ob tatsächlich eine Matrix in einem Bereich vorliegt.</p>
<section id="matrizen-erstellen" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="matrizen-erstellen"><span class="header-section-number">12.1</span> Matrizen erstellen</h2>
<p>In Excel können Matrizen auf drei Arten erstellt werden.</p>
<ol type="1">
<li>Durch direkte Eingabe</li>
<li>Durch das Überführen aus der Vektorform</li>
<li>Durch eine Operation mit einem Zeilen und einem Spaltenvektors</li>
<li>Erzeugen durch eine Generatorfunktion</li>
</ol>
<p>Bei der direkten Eingabe werden die Werte direkt in einen Bereich in Excel eingegeben. Am einfachsten wird dazu der Bereich der Matrix mit der Maus markiert und anschliessend werden die Werte eingegeben und mit der Eingabetaste oder der Tabulatortaste bestätigt. Excel bewegt die Markierung für die aktive Zelle im markierten Bereich automatisch an die nächste freie Position: Wird mit der Eingabetaste bestätigt, dann bewegt Excel die Eingabemarkierung <em>spaltensweise</em> durch den markierten Bereich. Wird die Eingabe mit der Tabulatortaste bestätigt, dann bewegt Excel die Eingabemarkierung <em>zeilenweise</em> durch den markierten Bereich.</p>
<p>Liegt eine <em>Vektorform</em> einer Matrix vor, dann kann sie mit den Funktionen <code>ZEILENUMBRUCH()</code> oder <code>SPALTENUMBRUCH()</code> in eine Matrix mit einer festen Spalten- bzw. Zeilenzahl erzeugt werden. Neben dem Ausgangsvektor erwarten diese Funktionen die Länge einer Zeile bzw. einer Spalte. Damit ein Vektor in eine Matrix konvertiert werden kann, muss die Länge des Vektors durch die Zeilen- bzw. Spaltenlänge teilbar sein. Erfüllt ein Vektor dieses Kriterium nicht, dann füllt Excel die Positionen bis zur vollständigen Zeile bzw. Spalte mit dem Wert <code>#NV</code> auf.</p>
<div id="exm-zeilenumbruch-matrix-gen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.1 (Matrix aus einer Sequenz erzeugen)</strong></span> &nbsp;</p>
<pre><code>=ZEILENUMBRUCH(SEQUENZ(12); 3)</code></pre>
</div>
<p>Jede Transformation mit einem Spalten- und einem Zeilenvektor erzeugt in Excel eine Matrix (s. <a href="#sec-äusseres-produkt" class="quarto-xref">Abschnitt&nbsp;<span>12.6.4</span></a>). Dabei werden die Werte über Kreuz ausgewertet, so dass jede Position der Matrix einer paarweisen Operation entspricht. Die dimensionalität der so erzeugten Matrix ist immer die Zeilenanzahl des Spaltenvektors und die Spaltenanzahl des Zeilenvektors.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Merke
</div>
</div>
<div class="callout-body-container callout-body">
<p>Operationen über einem Spalten- und einem Zeilenvektor entsprechen dem äusseren Produkt. Das äussere Produkt ist in Excel nur für Vektoren definiert!</p>
</div>
</div>
<p>Mit den beiden Generatorfunktionen <code>SEQUENZ()</code> und <code>ZUFALLSMATRIX()</code> lassen sich Werte in matrizenartigen Bereichen erzeugen. Dazu wird die gewünschte Zeilen- und Spaltenanzahl als die ersten beiden Argumente übergeben. Die beiden Funktionen füllen anschliessend den angegebenen Bereich mit Werten.</p>
</section>
<section id="matrixdimensionen" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="matrixdimensionen"><span class="header-section-number">12.2</span> Matrixdimensionen</h2>
<p>Die Dimensionen einer Matrix ergibt sich aus den Funktionen <code>ZEILEN()</code> und <code>SPALTEN()</code>. Beide Werte müssen getrennt bestimmt werden.</p>
</section>
<section id="matrixwerte-referenzieren" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="matrixwerte-referenzieren"><span class="header-section-number">12.3</span> Matrixwerte referenzieren</h2>
<p>Die Werte einer Matrix werden mit der Funktion <code>INDEX()</code> referenziert. Diese Funktion hat drei Parameter.</p>
<ol type="1">
<li>Die Matrix</li>
<li>Der Zeilenindex des gesuchten Werts</li>
<li>Der Spaltenindex der gesuchten Werts.</li>
</ol>
<p>Für den Zeilen- und den Spaltenindex können Vektoren angegeben werden, um mehrere Werte auf einmal zu referenzieren.</p>
<blockquote class="blockquote">
<div id="exm-index-with-vectors" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.2 (Werte der Matrix Diagonalen referenzieren)</strong></span> &nbsp;</p>
<pre><code>= INDEX(A1:D4; SEQUENZ(4); SEQUENZ(4))</code></pre>
<p>Weil diese Operation die gleiche Sequenz zwei Mal erzeugt, lässt sie sich mit <code>LET()</code> vereinfachen.</p>
<pre><code>=LET(
    diagonalenIndex; SEQUENZ(4);
    INDEX(A1:D4; diagonalenIndex; diagonalenIndex)
)</code></pre>
</div>
</blockquote>
<p>Um einzelne Spalten bzw. Zeilen zu referezieren sollten die Funktionen <code>SPALTENWAHL()</code> bzw. <code>ZEILENWAHL()</code> verwendet werden, weil sie nur einen Indexwert benötigen.</p>
</section>
<section id="vektorform" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="vektorform"><span class="header-section-number">12.4</span> Vektorform</h2>
<p>Die Vektorform einer Matrix wird in Excel durch die Funktionen <code>ZUSPALTE()</code> bzw. <code>ZUZEILE()</code> erzeugt. Die beiden Funktionen unterscheiden sich nur durch die Orientierung des Ergebnisvektors. Die zeilenweise Vektorform wird standardmässig von beiden Funktionen erzeugt. Um eine spaltenweise Vektorform zu erhalten, kann der dritte Parameter <code>scan_by_column</code> auf <code>WAHR</code> gesetzt werden.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Praxis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Enthält eine Matrix fehlende Werte, die durch den Fehlerwert <code>#NV</code> markiert sind, lassen sich diese in der Vektorform direkt entfernen, indem der zweite Parameter auf <code>2</code> (Fehlerwerte ignorieren) bzw. <code>3</code> (Leere Zellen und Fehlerwerte ignorieren) gesetzt wird.</p>
<p>Dabei muss beachtet werden, sich die Matrix anschliessend nicht mehr aus dem Vektor reproduzieren lässt.</p>
</div>
</div>
</section>
<section id="matrizen-vergleichen" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="matrizen-vergleichen"><span class="header-section-number">12.5</span> Matrizen vergleichen</h2>
<p>Zwei Matrizen sind genau dann gleich, wenn sie gleiche Anzahl von Zeilen und Spalten sowie an jedem Index den gleichen Wert haben. Intuitiv bietet sich der paarweise Vergleich der Indizes an. Existieren nicht alle Indizes in der jeweils anderen Matrix, füllt Excel die fehlenden Indizes mit einem Fehler auf. Das führt dazu, dass die logische Verknüpfung in diesen Fällen einen Fehler zurückgibt. Deshalb ist es notwendig, dass zusätzlich gprüft wird, ob das Ergebnis dieser Operation einen Fehlerwert ergibt (<a href="#exm-matrizen-vergleichen" class="quarto-xref">Beispiel&nbsp;<span>12.3</span></a>).</p>
<div id="exm-matrizen-vergleichen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.3 (Formel zum Vergleich von zwei Matrizen)</strong></span> &nbsp;</p>
<pre><code>= WENNFEHLER(
    UND(
        Matrix1!A1# = Matrix2!A1#
    );
    FALSCH
)</code></pre>
</div>
<p>Ein zweiter praktischer Vergleich ist das Überprüfen einer quadratischen Matrix. Dabei wir nur eine Matrix geprüft. Weil die Werte in diesem Fall keine Bedeutung haben ist die Formel sehr einfach (<a href="#exm-quadratische-matrix-prüfen" class="quarto-xref">Beispiel&nbsp;<span>12.4</span></a>).</p>
<div id="exm-quadratische-matrix-prüfen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.4 (Überprüfen einer quadratischen Matrix)</strong></span> &nbsp;</p>
<pre><code>= ZEILEN(Matrix1!a1#) = SPALTEN(Matrix1!A1#);</code></pre>
</div>
</section>
<section id="matrix-operationen" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="matrix-operationen"><span class="header-section-number">12.6</span> Matrix Operationen</h2>
<section id="matrizen-transponieren" class="level3" data-number="12.6.1">
<h3 data-number="12.6.1" class="anchored" data-anchor-id="matrizen-transponieren"><span class="header-section-number">12.6.1</span> Matrizen Transponieren</h3>
<p>Matrizen werden mit der Funktion <code>MTRANS()</code> transponiert. Dabei werden die Zeilen- und Spaltenindizes getauscht.</p>
<div id="exm-matrix-transponieren" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.5 (Eine Matrix transponieren)</strong></span> &nbsp;</p>
<pre><code>= MTRANS(Matrix1!A1#)</code></pre>
</div>
</section>
<section id="sec-vektoroperationen" class="level3" data-number="12.6.2">
<h3 data-number="12.6.2" class="anchored" data-anchor-id="sec-vektoroperationen"><span class="header-section-number">12.6.2</span> Skalar- und Vektoroperationen</h3>
<p>Alle Skalaroperationen werden von Excel wie erwartet ausgeführt: die Operation wird mit dem Skalar für jeden Wert der Matrix ausgeführt.</p>
<p>Bei Vektoroperationen ist die Orientierung des Vektors für das Verhalten der Operation bestimmend.</p>
<ul>
<li>Spaltenvektoren werden spaltenweise mit der Matrix verknüpft. Dabei werden die Werte mit dem jeweils gleichen Zeilenindex zusammengefasst.</li>
<li>Zeilenvektoren werden zeilenweise mit der Matrix verknüpft. Dabei werden die Werte mit dem jeweils gleichen Spaltenindex zusammengefasst.</li>
</ul>
<blockquote class="blockquote">
<div id="exm-vektoroperationen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.6 (Orientierung bei der Verknüpfung eines Vektors und einer Matrix.)</strong></span> &nbsp;</p>
<pre><code>= SEQUENZ(4) + SEQUENZ(4; 4)</code></pre>
<p>Obwohl die folgende Operation sehr ähnlich aussieht, hat sie ein anderes Ergebnis.</p>
<pre><code>= SEQUENZ(1; 4) + SEQUENZ(4; 4)</code></pre>
</div>
</blockquote>
<p>In beiden Fällen gilt, dass der Vektor genauso viele Zeilen bzw. Spalten haben muss, wie die verknüpfte Matrix, so dass für die Verknüpfungsoperation beide Operanden vorhanden sind. Fehlt einer der Operanden, dann ist die Verknüpfung für diesen Index <em>nicht definiert</em>, so dass Excel für diese Positionen einen <code>#NV</code>-Fehler erzeugt.</p>
<div id="def-partielle-verknüpfung" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 12.1</strong></span> Excel führt eine <strong>unvollständige</strong> bzw. <strong>partielle Vektoroperation</strong> durch, wenn nicht alle Indizes entweder im Vektor oder in der Matrix vorhanden sind.</p>
</div>
<div id="exm-unvollständige-vektoroperationen" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.7 (Orientierung bei der Verknüpfung eines Vektors und einer Matrix.)</strong></span> &nbsp;</p>
<pre><code>= SEQUENZ(5) + SEQUENZ(4; 4)</code></pre>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Für Skalar- und Vektoroperationen sind nur Operatoren und Funktionen zulässig, die einen <strong>Skalar</strong> zum Ergebnis haben. Grundsätzlich sind alle Arithmetischen und Vergleichsoperatoren sowie der Textketten-Operator <code>&amp;</code> für Skalar- und Vektoroperationen geeignet.</p>
<p><strong>Manche</strong> Operationen erzeugen einen Fehler, andere geben bei überschüssigen Werten den jeweils ersten Index aus.</p>
</div>
</div>
</section>
<section id="kreuzproduktmatrixprodukt" class="level3" data-number="12.6.3">
<h3 data-number="12.6.3" class="anchored" data-anchor-id="kreuzproduktmatrixprodukt"><span class="header-section-number">12.6.3</span> Kreuzprodukt/Matrixprodukt</h3>
<p>Das Kreuzprodukt (oder <em>innere Matrixprodukt</em>) ist die Entsprechung zur Multiplikation von zwei Skalaren. Diese Operation wird in Excel durch die Funktion <code>MMULT()</code> ausgeführt. Das Kreuzprodukt ist nicht transitiv. Deshalb ist die Reihenfolge der Operanden wichtig, denn für das Kreuzprodukt muss die Spaltenlänge der linken Matrix mit der Zeilenlänge der rechten Matrix übereinstimmen. Ist diese Bedinung nicht gegeben, dann erzeugt Excel einen <code>#WERT!</code>-Fehler.</p>
<p>Das Ergebnis des Kreuzprodukts ist eine Matrix mit der Zeilenlänge der linken und der Spaltenlänge der rechten Matrix.</p>
<p>Weil das Kreuzprodukt die Summe mit der Multiplikation verbindet, ergeben sich interessante Vereinfachungen, wenn die Werte einer Matrix nur die Werte <code>0</code> und <code>1</code> sind (s. <a href="#sec-zeilensummen" class="quarto-xref"><span>Kapitel 12.8.1</span></a> und <a href="#sec-cumsum" class="quarto-xref"><span>Kapitel 12.8.3</span></a>).</p>
<blockquote class="blockquote">
<div id="exm-summenprodukt" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.8 (Die Funktion <code>SUMMENPRODUKT()</code> als Kreuzprodukt)</strong></span> Die Funktion <code>SUMMENPRODUKT()</code> zwischen zwei Vektoren lässt sich auch als Kreuzprodukt formulieren:</p>
<pre><code>= MMULT(SEQUENZ(1;4); SEQUENZ(4))</code></pre>
<p>Das Ergebnis dieser Operation ist eine <span class="math inline">1 \times 1</span>-Matrix (bzw. ein Skalar), weil die linke Matrix nur eine Zeile und die rechte Matrix nur eine Spalte hat.</p>
</div>
</blockquote>
</section>
<section id="sec-äusseres-produkt" class="level3" data-number="12.6.4">
<h3 data-number="12.6.4" class="anchored" data-anchor-id="sec-äusseres-produkt"><span class="header-section-number">12.6.4</span> Das äussere Produkt</h3>
<p>In Excel ist das äussere Produkt nur für Vektoren (bzw. <code>1,n</code>- oder <code>m,1</code>-Matrizen) definiert. Dabei müssen die Vektoren unterschiedliche Orientierungen haben. Das Ergebnis ist dann eine <span class="math inline">m \times n</span>-Matrix, wobei <span class="math inline">m</span> die Länge des Spaltenvektors und <span class="math inline">n</span> die Länge des Zeilenvektors ist.</p>
<div id="exm-äusseres-vektorprodukt" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.9 (Multiplikationstabelle für das kleine Einmaleins erstellen)</strong></span> &nbsp;</p>
<pre><code>= SEQUENZ(10) * SEQUENZ(1;10)</code></pre>
</div>
<p>Das äusser Produkt ist nicht auf die Multiplikation beschränkt, sondern für beliebige Operationen, wobei die Operation einen <em>Skalar</em> zum Ergebnis haben muss. Dieser Wert wird am Kreuzungsindex der Ergebnismatrix eingesetzt.</p>
<p>Diese Eigenschaft wird dazu ausgenutzt, um Matrizen mit speziellen Eigenschaften zu konstruieren (<a href="#sec-triangle-matrix" class="quarto-xref">Abschnitt&nbsp;<span>12.8.2</span></a>).</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Werden beliebige Matrizen auf die gleiche Weise verknüpft, führt Excel eine paarweise Verknüpfung aus, die für alle nicht exisiterenden Index-Paare den Fehlerwert <code>#NV</code> erzeugt (<a href="#sec-paarweise-operationen" class="quarto-xref">Abschnitt&nbsp;<span>12.6.5</span></a>).</p>
</div>
</div>
<p>Wird ein Vergleich als Operator für das äussere Produkt verwendet, dann ist das Ergebnis der Operation ein Wahrheitswert. Um diesen Wahrheitswert in eine Zahl umzuwandeln, muss eine arithmetische Operation nachgereiht werden. Hierzu ist die Multiplikation mit <code>1</code> oder die Addition mit <code>0</code> üblich.</p>
<div id="exm-äusseres-produkt-vergleich" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.10 (Äusseres Produkt zum Erzeugen einer Dreiecksmatrix)</strong></span> &nbsp;</p>
<pre><code>= 1 * (SEQUENZ(4) &lt;= SEQUENZ(1;4))</code></pre>
</div>
</section>
<section id="sec-paarweise-operationen" class="level3" data-number="12.6.5">
<h3 data-number="12.6.5" class="anchored" data-anchor-id="sec-paarweise-operationen"><span class="header-section-number">12.6.5</span> Paarweise Operationen</h3>
<p>Werden beliebige Matrizen miteinander verknüpft, dann führt Excel eine paarweise Verknüpfung aus. D.h. ein Operator oder eine Funktion wird paarweise für die Werte mit den gleichen Indizes ausgeführt. Dabei handelt es sich um eine Verallgemeinerung der Vektoroperation (<a href="#sec-vektoroperationen" class="quarto-xref">Abschnitt&nbsp;<span>12.6.2</span></a>), wobei wie auch bei den Vektoroperationen die Operation nur ausgeführt werden kann, wenn für beide Operanden in der jeweiligen Matrix ein Wert existiert.</p>
<p>Bei paarweisen Operationen mit zwei Matrizen müssen beide Matrizen die gleichen Dimensionen haben. Ist diese Bedingung nicht gegeben, führt Excel eine <em>partielle Verknüpfung</em> (<a href="#def-partielle-verknüpfung" class="quarto-xref">Definition&nbsp;<span>12.1</span></a>) aus.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Merke
</div>
</div>
<div class="callout-body-container callout-body">
<p>Zwischen den paarweisen Operationen und dem äusseren Produkt besteht kein Zusammenhang. Für Vektoren bzw. <span class="math inline">1 \times n</span>-Matrizen führt Excel immer das äussere Produkt aus, für alle anderen Matrizen paarweise Operationen.</p>
</div>
</div>
</section>
</section>
<section id="mathematische-hilfsoperationen" class="level2" data-number="12.7">
<h2 data-number="12.7" class="anchored" data-anchor-id="mathematische-hilfsoperationen"><span class="header-section-number">12.7</span> Mathematische Hilfsoperationen</h2>
<p>Neben den bereits vorgestellten Operationen verfügt Excel über drei weitere Funktionen für <strong><em>quadratische Matrizen</em></strong>.</p>
<ul>
<li><code>MEINHEIT()</code></li>
<li><code>MINV()</code></li>
<li><code>MDET()</code></li>
</ul>
<section id="identitätsmatrix-erzeugen" class="level3" data-number="12.7.1">
<h3 data-number="12.7.1" class="anchored" data-anchor-id="identitätsmatrix-erzeugen"><span class="header-section-number">12.7.1</span> Identitätsmatrix erzeugen</h3>
<p>Die Funktion <code>MEINHEIT()</code> erzeugt eine Identitätsmatrix mit der angegebenen Zeilen-/Spaltenanzahl. Die Identitätsmatrix ist eine quadratische Diagonalmatrix mit den Wert <code>1</code> entlang der Diagonalen und dem Wert <code>0</code> an allen anderen Positionen.</p>
<div id="exm-einheitsmatrix" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.11 (Einheitsmatrix der Grösse 5)</strong></span> &nbsp;</p>
<pre><code>= MEINHEIT(5)</code></pre>
</div>
</section>
<section id="determinante" class="level3" data-number="12.7.2">
<h3 data-number="12.7.2" class="anchored" data-anchor-id="determinante"><span class="header-section-number">12.7.2</span> Determinante</h3>
<p>Eine wichtige Kennzahl für quadratische Matrizen ist die Determinante. Sie wird mit der Funktion <code>MDET()</code> berechnet.</p>
<div id="exm-determinante-seqmatrix" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.12 (Bestimmung der Determinante einer Matrix)</strong></span> &nbsp;</p>
<pre><code>=MDET(SPALTENUMBRUCH(SEQUENZ))</code></pre>
</div>
</section>
<section id="inverse-matrix" class="level3" data-number="12.7.3">
<h3 data-number="12.7.3" class="anchored" data-anchor-id="inverse-matrix"><span class="header-section-number">12.7.3</span> Inverse Matrix</h3>
<p>Für viele Berechnungen ist die Inverse <span class="math inline">A^{-1}</span> einer quadratischen Matrix <span class="math inline">A</span> notwendig. Falls eine Matrix invertierbar ist, gibt die Funktion <code>MINV()</code> die Inverse zurück. Diese Funktion löst die Gleichung <span class="math inline">A \times A^{-1} = I</span> und bestimmt die Inverse Matrix <span class="math inline">A^{-1}</span>.</p>
<div id="exm-inverse-matrix" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.13 (Inverse einer <span class="math inline">4 \times 4</span>-Matrix)</strong></span> &nbsp;</p>
<pre><code>=MINV(
    ZEILENUMBRUCH(
        SEQUENZ(16);
        4
    )
)</code></pre>
</div>
<p>Ist die Matrix nicht invertierbar, dann gibt die Funktion den Fehler <code>#ZAHL!</code> zurück. In diesem Fall ist die Determinante gleich <code>0</code>.</p>
<div id="exm-inverse-matrix" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 12.14 (Nicht-invertiertbare <span class="math inline">4 \times 4</span>-Matrix)</strong></span> &nbsp;</p>
<pre><code>=MINV(
    SPALTENUMBRUCH(
        SEQUENZ(16);
        4
    )
)</code></pre>
</div>
<p>Wird der Funktion keine quadratische Matrix übergeben, dann hat diese Funktion einen <code>#WERT!</code> zum Ergebnis.</p>
</section>
</section>
<section id="rezepte" class="level2" data-number="12.8">
<h2 data-number="12.8" class="anchored" data-anchor-id="rezepte"><span class="header-section-number">12.8</span> Rezepte</h2>
<p>Die folgenden Rezepte Nutzen das Kreuzprodukt und das äussere Produkt.</p>
<section id="sec-zeilensummen" class="level3" data-number="12.8.1">
<h3 data-number="12.8.1" class="anchored" data-anchor-id="sec-zeilensummen"><span class="header-section-number">12.8.1</span> Zeilen- und Spaltensummen</h3>
<p>Es sollen die Summen für jede Zeile einer Matrix (oder Tabelle) berechnet werden und das Ergebnis soll ein Vektor sein.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hinweis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Für die Excel-Formeln wird angenommen, dass eine Matrix an der Adresse <code>M1</code> vektorisiert vorliegt. In der Praxis muss den entsprechenden Parametern die korrekte Adresse der Matrix übergeben werden.</p>
</div>
</div>
<section id="lösung" class="level4" data-number="12.8.1.1">
<h4 data-number="12.8.1.1" class="anchored" data-anchor-id="lösung"><span class="header-section-number">12.8.1.1</span> Lösung</h4>
<pre class="excel"><code>= MMULT(M1#; SEQUENZ(SPALTEN(M1#);1;1;0))</code></pre>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Praxis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Diese Operation ist bei der Arbeit mit Excel wichtig, weil diese Operation in Excel effizienter ist, als zeilenweise Aggregationen über vektorisierte oder nicht-verktorisierte Daten.</p>
</div>
</div>
</section>
<section id="erklärung" class="level4" data-number="12.8.1.2">
<h4 data-number="12.8.1.2" class="anchored" data-anchor-id="erklärung"><span class="header-section-number">12.8.1.2</span> Erklärung</h4>
<p>Um Zeilensummen für eine Matrix zu erstellen, nutzen wir die Eigenschaften des Kreuzprodukts aus und multiplizieren eine Matrix mit dem Einsvektor. Das Ergebnis dieser Operation ist ein Vektor, der in jeder Zeile die Summe der Werte aus der entsprechenden Zeile der Matrix enthält.</p>
<p>Das Kreuzprodukt ist nur für Matrizen definiert, wenn die erste (linke) Matrix <span class="math inline">A</span> gleich viele Spalten hat, wie die Zeilenanzahl der zweiten (rechten) Matrix <span class="math inline">B</span>. Die Ergebnismatrix des Kreuzprodukts hat gleich viele Zeilen, wie die erste Matrix und gleich viele Spalten wie die zweite. Für jede Position <span class="math inline">c_{ij}</span> der Ergebnismatrix <span class="math inline">C</span> gilt dann die folgende Formel:</p>
<p><span class="math display">
c_{ij} = \sum^n_{k=1}{a_{ik}b_{kj}}
</span></p>
<p>Um die Zeilensummen einer Matrix <span class="math inline">A</span> zu erhalten, müssen wir die Matrix <span class="math inline">B</span> entsprechend konstruieren.</p>
<ol type="1">
<li>Matrix <span class="math inline">B</span> darf nur eine Spalte haben, damit die Ergebnismatrix nur eine Spalte hat.</li>
<li>Matrix <span class="math inline">B</span> darf die Werte in Matrix <span class="math inline">A</span> nicht verändern.</li>
<li>Matrix <span class="math inline">B</span> muss gleich viele Zeilen haben, wie Matrix <span class="math inline">A</span> Spalten hat.</li>
</ol>
<p>Diese Anforderungen 1 und 2 werden durch den Einsvektor mit <code>n</code>-Zeilen erfüllt. Dabei nutzen wir aus, dass ein Spaltenvektor das gleiche wie eine Matrix mit einer Spalte ist.</p>
<p>Die Anforderungen 3 können wir über die Spaltenzahl der Matrix bestimmen und erstellen dann einen Einsvektor mit entsprechender Zeilenanzahl.</p>
<p>Daraus ergibt sich für den Einsvektor <span class="math inline">v_e</span> und der Matrix an Adresse <code>M1</code> die Formel:</p>
<pre><code>=SEQUENZ(SPALTEN(M1#); 1; 1; 0)</code></pre>
<p>Weil der Einsvektor an jeder Position das neutrale Element der Multiplikation enthält, vereinfacht sich die Formel für das Kreuzprodukt stark:</p>
<p><span class="math display">
c_{i1} = \sum^n_{k=1}{a_{ik}}
</span></p>
<p>Bei dieser Formel ist zu beachten, dass die 1 in <span class="math inline">c_{i1}</span> für die einzige Spalte des Einsvektors steht und i für die Zeilen in der Matrix A. Daraus wird deutlich, dass wir nun die Zeilensummen für die Matrix A erhalten.</p>
<p>Der Einsvektor muss bei dieser Operation als die rechte Matrix eingesetzt werden, sodass gilt:</p>
<p><span class="math display">
A \times v_e
</span></p>
<p>Als Excel-Formel wird das wie folgt ausgedrückt:</p>
<pre><code>=MMULT(M1#; SEQUENZ(SPALTEN(M1#); 1; 1; 0))</code></pre>
<p>Aus dieser Lösung lässt sich auch die Spaltensumme ableiten: Für die Spaltensumme muss das neutrale Element der Multiplikation in die erste Matrix wandern. Dazu wird ein <em>Zeilenvektor</em> erstellt und mit diesem das Kreuzprodukt mit der Matrix gebildet. Weil in diesem Fall die Spaltensumme gebildet werden soll, kommen die Werte für die Spalten aus der rechten Matrix. Deshalb müssen wir das Kreuzprodukt wie folgt bilden:</p>
<p><span class="math display">
v_e \times B
</span></p>
<p>Daraus ergibt sich die folgende Excel-Formel:</p>
<pre class="excel"><code>= MMULT(SEQUENZ(1; ZEILEN(M1#); 1; 0); M1#)</code></pre>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Praxis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bei der Zeilen- und Spaltensumme handelt es sich um ein sogenanntes <em>Muster</em>, dass an verschiedenen Stellen verwendet werden kann. Ein <em>Muster</em> ist im Kern eine <em>Funktion</em>, die <em>parametrisiert</em> werden kann.</p>
</div>
</div>
<p>Wir können dieses Muster mit der Funktion <code>LET()</code> (<a href="https://moodle.zhaw.ch/mod/page/view.php?id=544755">zum Exkurs über die <code>LET()</code>-Funktion</a>) so anpassen, dass wir den Bereich für unsere Matrix nur einmal anpassen müssen.</p>
<p>Daraus ergeben sich die folgenden Excel-Formeln:</p>
<ul>
<li>Zeilensumme: <code>= LET(Matrix; M1#; MMULT(Matrix; SEQUENZ(SPALTEN(Matrix); 1; 1; 0)))</code></li>
<li>Spaltensumme: <code>= LET(Matrix; M1#; MMULT(SEQUENZ(1; ZEILEN(Matrix); 1; 0); Matrix))</code></li>
</ul>
</section>
</section>
<section id="sec-triangle-matrix" class="level3" data-number="12.8.2">
<h3 data-number="12.8.2" class="anchored" data-anchor-id="sec-triangle-matrix"><span class="header-section-number">12.8.2</span> Dreieckmatrizen erzeugen</h3>
<p>Es soll eine quadratische Dreiecksmatrix mit <span class="math inline">n</span>-Zeilen erzeugt werden.</p>
<section id="lösung-1" class="level4" data-number="12.8.2.1">
<h4 data-number="12.8.2.1" class="anchored" data-anchor-id="lösung-1"><span class="header-section-number">12.8.2.1</span> Lösung</h4>
<p>Die Anzahl der Zeilen befindet sich in diesem Beispiel an Adresse <code>A1</code>.</p>
<p>Obere Dreiecksmatrix</p>
<pre><code>= 1 * (SEQUENZ(A#) &lt;= SEQUENZ(1; A1#))</code></pre>
<p>Untere Dreiecksmatrix</p>
<pre><code>= 1 * (SEQUENZ(A#) &gt;= SEQUENZ(1; A1#))</code></pre>
</section>
<section id="erklärung-1" class="level4" data-number="12.8.2.2">
<h4 data-number="12.8.2.2" class="anchored" data-anchor-id="erklärung-1"><span class="header-section-number">12.8.2.2</span> Erklärung</h4>
<p>Bei einer Dreiecksmatrix steht unterhalb bzw. oberhalb der Diagonalen der Wert 1 und sonst der Wert <code>0</code>. Gelegentlich (wie in der obigen Lösung) wird die Diagonale zu den mit <code>1</code> belegten Positionen hinzugezählt.</p>
<p>Die Lösung nutzt aus, dass Excel bei unterschiedlich orientierten Vektoren das äussere Produkt bildet und so eine Matrix erzeugt. Die Basis für diese Operation bilden zwei Sequenzen, die über kreuz verglichen werden.</p>
<p>Die Sequenzen können dabei als Nummerierungen der Matrixpositionen verstanden werden. Der Vergleich ergibt jeweils bis zur Diagonalen <code>FALSCH</code> und ab der Diagonalen <code>WAHR</code>, weil die Nummerierung der Positionen ab der Diagonalen <em>gleich</em> ist.</p>
<p>Die Multiplikation mit <code>1</code> ist notwendig, damit die Matrix Zahlen und keine Wahrheitswerte enthält.</p>
</section>
</section>
<section id="sec-cumsum" class="level3" data-number="12.8.3">
<h3 data-number="12.8.3" class="anchored" data-anchor-id="sec-cumsum"><span class="header-section-number">12.8.3</span> Kumulative Summe</h3>
<p>Es soll die kumulative Summe eines Vektors gebildet werden.</p>
<section id="lösung-2" class="level4" data-number="12.8.3.1">
<h4 data-number="12.8.3.1" class="anchored" data-anchor-id="lösung-2"><span class="header-section-number">12.8.3.1</span> Lösung</h4>
<p>Für Spaltenvektoren:</p>
<pre><code>=LET(
    VLAENGE; ZEILEN(A1#); 
    MMULT(
        A1#; 
        1 * (SEQUENZ(VLAENGE) &gt;= SEQUENZ(1; VLAENGE))
    )
)</code></pre>
<p>Für Zeilenvektoren:</p>
<pre><code>=LET(
    HLAENGE; SPALTEN(A1#); 
    MMULT( 
        1 * (SEQUENZ(HLAENGE) &lt;= SEQUENZ(1; HLAENGE));
        A1#
    )
)</code></pre>
</section>
<section id="erklärung-2" class="level4" data-number="12.8.3.2">
<h4 data-number="12.8.3.2" class="anchored" data-anchor-id="erklärung-2"><span class="header-section-number">12.8.3.2</span> Erklärung</h4>
<p>Die kumulative Summe dreht die Logik der Zeilen- bzw. Spaltensumme um. In diesem Fall wird eine Matrix erzeugt, die für jede Position im Vektor anzeigt, welche Vektorwerte summiert werden sollen. Entsprechend darf diese Matrix nur die Werte <code>0</code> oder <code>1</code> enthalten, da die Werte im Ausgangsvektor nicht verändert werden dürfen.</p>
<p>Für die kumulative Summe müssen alle Werte bis und mit der aktuellen Position summiert werden. Eine Dreiecksmatrix leistet genau diesen Zweck: Für Spaltenvektoren zeigt die untere Dreickesmatrix zeilenweise an, welche Positionen für die kumulative Summe berücksichtigt werden müssen.</p>
<p>Weil die Diagonale der Dreiecksmatrix die gleiche Länge hat wie der Ausgangsvektor, ist sichergestellt, dass der Ergebnisvektor die gleiche Länge wie der Ausgangsvektor hat.</p>
<p>Dieser Trick funktioniert nur, wenn die das neutrale Element der Multiplikation in der Dreiecksmatrix verwendet wird.</p>
</section>
</section>
<section id="sec-table-matrix" class="level3" data-number="12.8.4">
<h3 data-number="12.8.4" class="anchored" data-anchor-id="sec-table-matrix"><span class="header-section-number">12.8.4</span> Co-Occurence Matrizen</h3>
<p>Es sollen die gemeinsam auftretenden Werte in zwei <strong>diskretskalierten Vektoren</strong> gezählt werden und in einer <em>Kreuztabelle</em> gegenübergestellt werden.</p>
<section id="lösung-3" class="level4" data-number="12.8.4.1">
<h4 data-number="12.8.4.1" class="anchored" data-anchor-id="lösung-3"><span class="header-section-number">12.8.4.1</span> Lösung</h4>
<p>Für Spaltenvektoren:</p>
<pre><code>=MMULT(
    1 * (EINDEUTIG(A1#) = MTRANS(A1#)); 
    1 * (MTRANS(EINDEUTIG(B1#)) = B1#)
)</code></pre>
</section>
<section id="erklärung-3" class="level4" data-number="12.8.4.2">
<h4 data-number="12.8.4.2" class="anchored" data-anchor-id="erklärung-3"><span class="header-section-number">12.8.4.2</span> Erklärung</h4>
<p>Im ersten Schritt werden für jeden Vektor separat die Positionen der eindeutigen Werte in einer Matrix markiert. Die eindeutigen Werte sind die Werte vorkommenden Werte des Wertebereichs. Diese Werte werden mit der Funktion <code>EINDEUTIG()</code> bestimmt. Das Ergebnis des ersten Schritts ist eine Matrix, die nur die Werte <code>1</code> und <code>0</code> enthält. Der Wert <code>1</code> ist an der Position gesetzt, an der ein Wert des Wertebeichs im Ausgangsvektor gefunden wurde.Dazu dient die folgende Formel:</p>
<pre><code>= 1 * (EINDEUTIG(A1#) = MTRANS(A1#))</code></pre>
<p>Diese Formel lässt sich auf beide Ausgangsvektoren anwenden. Dadurch ergeben zwei Matrizen mit gleich vielen Spalten, die nur die Werte <code>1</code> und <code>0</code> enthalten.</p>
<p>Damit die gemeinsamen Vorkommnisse gezählt werden, wird das Kreuzprodukt verwendet. Dabei wird ausgenutzt, dass das Kreuzprodukt die Produkte der Zeilen- und Spaltenwerte summiert. Weil beide Matrizen nur die Werte <code>0</code> und <code>1</code> enthalten, entspricht diese Operation dem <em>Zählen durch Summieren</em>.</p>
<p>Diese Operation zählt nur das gemeinsame Auftreten, weil in beiden Matrizen sichergestellt ist, dass in jeder Spalte genau eine <code>1</code> vorkommt, werden nur die Werte an den gleichen Positionen in den Ausgangsvektoren gezählt.</p>
<p>Damit dieser Trick funktioniert, muss eine der beiden Matrizen transponiert werden, bevor das Kreuzprodukt gebildet werden kann. Daraus ergibt sich die folgende Formel.</p>
<pre><code>= MMULT(
    1 * (EINDEUTIG(A1#) = MTRANS(A1#));
    MTRANS(1 * (EINDEUTIG(B1#) = MTRANS(B1#)))
)</code></pre>
<p>An dieser Formel ist wenig elegant, dass für den zweiten Parameter zwei Mal transponiert wird. Dieser Teilterm lässt sich dadurch vereinfachen, indem die zweite Transponierung bereits bei der Erzeugung der Matrix vorweggenommen wird, denn es gilt:</p>
<pre><code>MTRANS(1 * (EINDEUTIG(B1#) = MTRANS(B1#)))</code></pre>
<p><em>ist equivalent mit</em></p>
<pre><code>1 * (MTRANS(EINDEUTIG(B1#)) = B1#)</code></pre>
<p>Wird diese Vereinfachung in die obige Formel eingesetzt, dann ergibt sich die Formel der Lösung.</p>
<p>Das Ergebnis ist eine sog. Kontingenztabelle, die die Häufigkeiten der gemeinsam auftretenden Werte anzeigt.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../kapitel/vektor-operationen/kapitel.html" class="pagination-link" aria-label="Vektoroperationen">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Vektoroperationen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../kapitel/kodieren-gruppieren/kapitel.html" class="pagination-link" aria-label="Indizieren und Gruppieren">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Indizieren und Gruppieren</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dxiai/dxi-excel/issues/new" class="toc-action"><i class="bi bi-github"></i>Problem melden</a></li></ul></div></div></div></footer></body></html>